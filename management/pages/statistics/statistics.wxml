<!--pages/statistics/statistics.wxml-->
<navigation-bar title="åº“å­˜ç»Ÿè®¡" back="{{true}}" backAsHome="{{true}}" color="black" background="#FFF"></navigation-bar>
<scroll-view class="scrollarea" scroll-y type="list" refresher-enabled="{{true}}" bindrefresherrefresh="onPullDownRefresh">
  <view class="container">
    <!-- å‘Šè­¦æ¦‚è§ˆ -->
    <view class="warning-overview" wx:if="{{hasWarnings}}">
      <view class="warning-title">å‘Šè­¦æé†’</view>
      <view class="warning-items">
        <view class="warning-item low-stock" wx:if="{{lowStockCount > 0}}">
          <text class="warning-icon">âš ï¸</text>
          <text class="warning-text">{{lowStockCount}}ç§ç‰©å“åº“å­˜ä¸è¶³</text>
        </view>
        <view class="warning-item expiry" wx:if="{{expiryWarningCount > 0}}">
          <text class="warning-icon">â°</text>
          <text class="warning-text">{{expiryWarningCount}}ç§ç‰©å“å³å°†è¿‡æœŸ</text>
        </view>
      </view>
    </view>

    <!-- åº“å­˜åˆ—è¡¨ï¼šåç§°+è´§æ¶+æ ‡ç­¾+å…¥åº“æ—¶é—´+åˆ°æœŸæ—¶é—´+æ•°é‡ï¼Œå°äºè¿‡æœŸæé†’æ—¶é—´åˆ™å‘Šè­¦ -->
    <view class="section-title">åº“å­˜æ˜ç»†</view>
    <view class="stats-list" wx:if="{{list.length > 0}}">
      <view class="stats-row {{item.expiryWarning ? 'row-expiry-alarm' : ''}}" wx:for="{{list}}" wx:key="id">
        <view class="row-left">
          <view class="row-name-wrap">
            <text class="row-name">{{item.itemType}}</text>
            <text class="row-location" wx:if="{{item.location}}">è´§æ¶ï¼š{{item.location}}</text>
            <view class="row-tag" wx:if="{{item.tag}}" style="background-color: {{item.tag}}"></view>
          </view>
          <view class="row-meta">
            <text class="row-meta-item">å…¥åº“ï¼š{{item.inboundDate || 'æ— '}}</text>
            <text class="row-meta-item">åˆ°æœŸï¼š{{item.expiryDate || 'æ— '}}</text>
          </view>
        </view>
        <view class="row-right">
          <text class="row-qty">{{item.quantity}}</text>
          <text class="row-alarm" wx:if="{{item.expiryWarning}}">å³å°†è¿‡æœŸ</text>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{list.length === 0}}">
      <text class="empty-icon">ğŸ“¦</text>
      <text class="empty-text">æš‚æ— åº“å­˜æ•°æ®</text>
      <text class="empty-hint">è¯·å…ˆè¿›è¡Œå…¥åº“æ“ä½œ</text>
    </view>
  </view>
</scroll-view>
